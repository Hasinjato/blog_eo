<!DOCTYPE html>
<html lang="fr">

<head>
    <title> Tableau de bord | Utilisateurs</title>
    <!-- HTML5 Shim and Respond.js IE10 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 10]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
      <![endif]-->
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="#">
    <meta name="keywords" content="Admin , Responsive, Landing, Bootstrap, App, Template, Mobile, iOS, Android, apple, creative app">
    <meta name="author" content="#">
    <!-- Favicon icon -->
    <link rel="icon" href="../template/Adminty/dashboard_cumstomize-master/files/assets/images/favicon.ico" type="image/x-icon">
    <!-- Google font-->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet">
    <!-- Required Fremwork -->
    <link rel="stylesheet" type="text/css" href="../template/Adminty/dashboard_cumstomize-master/files/bower_components/bootstrap/css/bootstrap.min.css">
    <!-- feather Awesome -->
    <link rel="stylesheet" type="text/css" href="../template/Adminty/dashboard_cumstomize-master/files/assets/icon/feather/css/feather.css">
    <!-- font Awesome 6 -->
    <link rel="stylesheet" type="text/css" href="../fontawesome-free-6.4.0-web/css/all.min.css">
    <!-- Style.css -->
    <link rel="stylesheet" type="text/css" href="../template/Adminty/dashboard_cumstomize-master/files/assets/css/style.css">
    <link rel="stylesheet" type="text/css" href="../template/Adminty/dashboard_cumstomize-master/files/assets/css/jquery.mCustomScrollbar.css">
</head>

<body>
    <!-- Pre-loader start -->
    <div class="theme-loader">
        <div class="ball-scale">
            <div class='contain'>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
            </div>
        </div>
    </div>
    <!-- Pre-loader end -->
    <div id="pcoded" class="pcoded">
        <div class="pcoded-overlay-box"></div>
        <div class="pcoded-container navbar-wrapper">
        <%-include('../dash_header.ejs') %>
            <!-- Sidebar -->
            <div class="pcoded-main-container">
                <div class="pcoded-wrapper">
            <%-include ('sidebar.ejs') %> 
                    <div class="pcoded-content">
                        <div class="pcoded-inner-content">
                            <div class="main-body">
                                <div class="page-wrapper">
                                    <div class="label-main d-inline">
                                        <div class="label label-lg label-primary">
                                            <h2 class="m-0 d-inline">Les utilisateurs</h2> 
                                            <div class="f-right d-inline">
                                                <a href="/users/create">Ajouter utilisateur</a>
                                                <i class="fa fa-user h2"></i>
                                                <label class="badge badge-primary badge-top-right"><%= users.length%></label>
                                            </div>
                                        </div>                           
                                    </div>
                                    <div class="page-body">
                                        <!-- Default table border table start-->
                                        <div class="card-block table-border-style">
                                            <div class="table-responsive">
                                                <table class="table table-xl table-styling table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th>#</th>
                                                            <th>Nom d'utilisateur</th>
                                                            <th>Image</th>
                                                            <th>RÃ´le</th>
                                                            <th>Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <% users.forEach((user, index) => { %>
                                                        <tr>
                                                            <th scope="row"><%= index + 1 %></th>
                                                            <td><%= user.username %></td>
                                                            <td><img class="w-100" src="/uploads/<%= user.image %>" alt=""></td>
                                                            <td><%= user.role %></td>
                                                            <td>
                                                                <a href="/users/<%= user._id %>">Afficher</a>
                                                                <a href="/users/<%= user._id %>/edit">Modifier</a>
                                                                    <button onClick="deleteUser('<%= user._id %>')">Supprimer</button>
                                                            </td>
                                                            <!--<td style="white-space: nowrap; width: 1%;"><div class="tabledit-toolbar btn-toolbar" style="text-align: left;">
                                                                <div class="btn-group btn-group-sm" style="float: none;">
                                                                    <a href="/dashboard/users/<%= user._id %>">
                                                                        Voir
                                                                    </a>
                                                                    <button type="button" class="tabledit-edit-button btn btn-primary waves-effect waves-light" style="float: none;margin: 5px;">
                                                                        <a href="/dashboard/users/<%= user._id %>/edit">
                                                                            <span class="fa fa-edit"></span>
                                                                        </a>
                                                                    </button>
                                                                    <form action="/dashboard/users/<%= user._id %>?_method=DELETE" method="POST">
                                                                        <button type="submit" class="tabledit-delete-button btn btn-danger waves-effect waves-light" style="float: none;margin: 5px;">
                                                                            <span class="far fa-trash-alt"></span>
                                                                        </button>
                                                                    </form>
                                                                </div>
                                                                <button type="button" class="tabledit-save-button btn btn-sm btn-success" style="display: none; float: none;">Save</button>
                                                                <button type="button" class="tabledit-confirm-button btn btn-sm btn-danger" style="display: none; float: none;">Confirm</button>
                                                                <button type="button" class="tabledit-restore-button btn btn-sm btn-warning" style="display: none; float: none;">Restore</button>
                                                            </div></td>-->
                                                        </tr>
                                                        <% }); %>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div> 
                                        <!-- Default table border table end-->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>    
        </div>
    </div>

    <!-- Warning Section Starts -->
    <!-- Older IE warning message -->
    <!--[if lt IE 10]>
<div class="ie-warning">
    <h1>Warning!!</h1>
    <p>You are using an outdated version of Internet Explorer, please upgrade <br/>to any of the following web browsers to access this website.</p>
    <div class="iew-container">
        <ul class="iew-download">
            <li>
                <a href="http://www.google.com/chrome/">
                    <img src="../files/assets/images/browser/chrome.png" alt="Chrome">
                    <div>Chrome</div>
                </a>
            </li>
            <li>
                <a href="https://www.mozilla.org/en-US/firefox/new/">
                    <img src="../files/assets/images/browser/firefox.png" alt="Firefox">
                    <div>Firefox</div>
                </a>
            </li>
            <li>
                <a href="http://www.opera.com">
                    <img src="../files/assets/images/browser/opera.png" alt="Opera">
                    <div>Opera</div>
                </a>
            </li>
            <li>
                <a href="https://www.apple.com/safari/">
                    <img src="../files/assets/images/browser/safari.png" alt="Safari">
                    <div>Safari</div>
                </a>
            </li>
            <li>
                <a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie">
                    <img src="../files/assets/images/browser/ie.png" alt="">
                    <div>IE (9 & above)</div>
                </a>
            </li>
        </ul>
    </div>
    <p>Sorry for the inconvenience!</p>
</div>
<![endif]-->
    <!-- Warning Section Ends -->
    <!-- Required Jquery -->
    <script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/bower_components/jquery/js/jquery.min.js"></script>
    <script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/bower_components/jquery-ui/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/bower_components/popper.js/js/popper.min.js"></script>
    <script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/bower_components/bootstrap/js/bootstrap.min.js"></script>
    <!-- jquery slimscroll js -->
    <script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/bower_components/jquery-slimscroll/js/jquery.slimscroll.js"></script>
    <!-- modernizr js -->
    <script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/bower_components/modernizr/js/modernizr.js"></script>
    <!-- Chart js -->
    <script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/bower_components/chart.js/js/Chart.js"></script>
    <!-- amchart js -->
    <script src="../template/Adminty/dashboard_cumstomize-master/files/assets/pages/widget/amchart/amcharts.js"></script>
    <script src="../template/Adminty/dashboard_cumstomize-master/files/assets/pages/widget/amchart/serial.js"></script>
    <script src="../template/Adminty/dashboard_cumstomize-master/files/assets/pages/widget/amchart/light.js"></script>
    <script src="../template/Adminty/dashboard_cumstomize-master/files/assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/assets/js/SmoothScroll.js"></script>
    <script src="../template/Adminty/dashboard_cumstomize-master/files/assets/js/pcoded.min.js"></script>
    <!-- custom js -->
    <script src="../template/Adminty/dashboard_cumstomize-master/files/assets/js/vartical-layout.min.js"></script>
    <script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/assets/pages/dashboard/custom-dashboard.js"></script>
    <script type="text/javascript" src="../template/Adminty/dashboard_cumstomize-master/files/assets/js/script.min.js"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-23581568-13');
</script>
<script>
    function deleteUser(userId) {
        if(confirm("Voulez-vous supprimer cet utilisateur ?")) {
            fetch(`/users/${userId}`, { method: 'DELETE',
            })
            .then(() => {
            window.location.reload();
            })
            .catch((error) => {
                console.log(error)
            });
        }
    }
</script>
</body>

</html>
